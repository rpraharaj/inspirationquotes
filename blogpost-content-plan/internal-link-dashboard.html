<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Analytics Dashboard | AI Agents Kit</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #111113;
            --bg-tertiary: #1a1a1d;
            --bg-hover: #222225;
            --border-color: #2a2a2d;
            --text-primary: #fff;
            --text-secondary: #a0a0a5;
            --text-muted: #6b6b70;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-orange: #f97316;
            --accent-red: #ef4444;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green-dim: rgba(34, 197, 94, 0.15);
            --accent-yellow-dim: rgba(234, 179, 8, 0.15);
            --accent-orange-dim: rgba(249, 115, 22, 0.15);
            --accent-red-dim: rgba(239, 68, 68, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header & Tabs */
        .header {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 32px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header h1 {
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-tertiary);
            padding: 4px;
            border-radius: 10px;
        }

        .tab-btn {
            padding: 10px 24px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab-btn.active {
            background: var(--accent-blue);
            color: white;
        }

        .refresh-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .refresh-btn:hover {
            border-color: var(--accent-blue);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            max-width: 1600px;
            margin: 0 auto;
            padding: 24px 32px;
        }

        .tab-content.active {
            display: block;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 16px;
            transition: all 0.2s;
        }

        .summary-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-blue);
        }

        .summary-card .value {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-blue));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .summary-card .label {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .summary-card.excellent .value {
            background: linear-gradient(135deg, var(--accent-green), #4ade80);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .summary-card.warning .value {
            background: linear-gradient(135deg, var(--accent-orange), var(--accent-yellow));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .summary-card.danger .value {
            background: linear-gradient(135deg, var(--accent-red), var(--accent-orange));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Charts */
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
        }

        .chart-card h3 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .seo-distribution {
            display: flex;
            gap: 12px;
        }

        .seo-bar {
            flex: 1;
            text-align: center;
        }

        .seo-bar .bar-container {
            height: 100px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            display: flex;
            align-items: flex-end;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .seo-bar .bar {
            width: 100%;
            border-radius: 6px 6px 0 0;
            transition: height 0.5s;
        }

        .seo-bar.excellent .bar {
            background: linear-gradient(180deg, var(--accent-green), #16a34a);
        }

        .seo-bar.good .bar {
            background: linear-gradient(180deg, var(--accent-yellow), #ca8a04);
        }

        .seo-bar.needs-work .bar {
            background: linear-gradient(180deg, var(--accent-orange), #ea580c);
        }

        .seo-bar.poor .bar {
            background: linear-gradient(180deg, var(--accent-red), #dc2626);
        }

        .seo-bar .count {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .seo-bar .label {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 250px;
            overflow-y: auto;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-item .name {
            width: 120px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .category-item .bar-bg {
            flex: 1;
            height: 20px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .category-item .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-blue));
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding-left: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            transition: width 0.5s;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .quick-stats {
                grid-template-columns: 1fr;
            }
        }

        .quick-stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 16px;
        }

        .quick-stat-card h3 {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .quick-stat-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .quick-stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .quick-stat-item a {
            color: var(--text-primary);
            text-decoration: none;
            max-width: 75%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .quick-stat-item a:hover {
            color: var(--accent-blue);
        }

        .quick-stat-item .badge {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .quick-stat-item .badge.orphan {
            background: var(--accent-red-dim);
            color: var(--accent-red);
        }

        .quick-stat-item .badge.hub {
            background: var(--accent-purple);
            color: white;
        }

        /* Filters Panel - Tab 2 */
        .filters-panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filters-panel h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group input,
        .filter-group select {
            padding: 10px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .filter-group input::placeholder {
            color: var(--text-muted);
        }

        .range-inputs {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .range-inputs input {
            width: 80px;
        }

        .range-inputs span {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: var(--accent-blue);
            border: none;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            border-color: var(--accent-blue);
        }

        .btn-export {
            background: var(--accent-green);
            border: none;
            color: white;
            margin-left: auto;
        }

        .btn-export:hover {
            background: #16a34a;
        }

        /* Results Stats */
        .results-stats {
            display: flex;
            gap: 20px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 0.85rem;
            flex-wrap: wrap;
        }

        .results-stat {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .results-stat .num {
            font-weight: 700;
            color: var(--accent-blue);
        }

        /* Data Table */
        .table-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--bg-tertiary);
            padding: 12px 14px;
            text-align: left;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }

        .data-table th:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .data-table th.sorted {
            color: var(--accent-blue);
        }

        .data-table th .sort-icon {
            margin-left: 4px;
            opacity: 0.5;
        }

        .data-table th.sorted .sort-icon {
            opacity: 1;
        }

        .data-table td {
            padding: 12px 14px;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.82rem;
            vertical-align: middle;
        }

        .data-table tr:hover td {
            background: var(--bg-hover);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .post-title {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-width: 300px;
        }

        .post-title a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .post-title a:hover {
            color: var(--accent-blue);
        }

        .post-title .slug {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-family: monospace;
        }

        .category-badge {
            display: inline-block;
            padding: 3px 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .num-cell {
            font-weight: 600;
            font-variant-numeric: tabular-nums;
        }

        .num-cell.zero {
            color: var(--text-muted);
        }

        .num-cell.high {
            color: var(--accent-green);
        }

        .num-cell.low {
            color: var(--accent-red);
        }

        .seo-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .seo-badge.excellent {
            background: var(--accent-green-dim);
            color: var(--accent-green);
        }

        .seo-badge.good {
            background: var(--accent-yellow-dim);
            color: var(--accent-yellow);
        }

        .seo-badge.needsWork {
            background: var(--accent-orange-dim);
            color: var(--accent-orange);
        }

        .seo-badge.poor {
            background: var(--accent-red-dim);
            color: var(--accent-red);
        }

        .status-tags {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .status-tag {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-tag.orphan {
            background: var(--accent-red-dim);
            color: var(--accent-red);
        }

        .status-tag.hub {
            background: var(--accent-purple);
            color: white;
        }

        .status-tag.featured {
            background: var(--accent-blue);
            color: white;
        }

        .status-tag.no-image {
            background: var(--accent-orange-dim);
            color: var(--accent-orange);
        }

        .status-tag.no-faq {
            background: var(--accent-yellow-dim);
            color: var(--accent-yellow);
        }

        .expand-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: 0.7rem;
        }

        .expand-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .expanded-content {
            display: none;
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
        }

        .expanded-content.show {
            display: block;
        }

        .expanded-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        @media (max-width: 768px) {
            .expanded-grid {
                grid-template-columns: 1fr;
            }
        }

        .expanded-section h4 {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .expanded-section ul {
            list-style: none;
        }

        .expanded-section li {
            padding: 5px 0;
            font-size: 0.8rem;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .expanded-section li:last-child {
            border-bottom: none;
        }

        .expanded-section a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        .expanded-section a:hover {
            text-decoration: underline;
        }

        .seo-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-top: 12px;
        }

        .seo-metric {
            display: flex;
            justify-content: space-between;
            padding: 5px 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            font-size: 0.75rem;
        }

        .seo-metric .name {
            color: var(--text-secondary);
        }

        .seo-metric .points {
            font-weight: 600;
            color: var(--accent-green);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 20px;
            background: var(--bg-tertiary);
            border-top: 1px solid var(--border-color);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.82rem;
        }

        .pagination-controls {
            display: flex;
            gap: 6px;
        }

        .page-btn {
            padding: 6px 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .page-btn:hover:not(:disabled) {
            border-color: var(--accent-blue);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .loading::after {
            content: '';
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-content">
            <h1>üìä Blog Analytics Dashboard</h1>
            <div class="tabs">
                <button class="tab-btn active" data-tab="dashboard">üìà Overview</button>
                <button class="tab-btn" data-tab="posts">üìã Posts & Filters</button>
            </div>
            <div class="header-meta">
                <span id="last-updated">Loading...</span>
                <button class="refresh-btn" onclick="loadData()">üîÑ Refresh</button>
            </div>
        </div>
    </header>

    <!-- Tab 1: Dashboard Overview -->
    <div class="tab-content active" id="tab-dashboard">
        <section class="summary-grid" id="summary-cards">
            <div class="loading">Loading</div>
        </section>
        <section class="charts-section">
            <div class="chart-card">
                <h3>üìà SEO Score Distribution</h3>
                <div class="seo-distribution" id="seo-chart"></div>
            </div>
            <div class="chart-card">
                <h3>üìÇ Posts by Category</h3>
                <div class="category-list" id="category-chart"></div>
            </div>
        </section>
        <section class="quick-stats">
            <div class="quick-stat-card">
                <h3>‚ö†Ô∏è Orphan Pages (No Incoming Links)</h3>
                <div class="quick-stat-list" id="orphan-list"></div>
            </div>
            <div class="quick-stat-card">
                <h3>üåü Hub Pages (10+ Outgoing Links)</h3>
                <div class="quick-stat-list" id="hub-list"></div>
            </div>
        </section>
    </div>

    <!-- Tab 2: Posts & Advanced Filters -->
    <div class="tab-content" id="tab-posts">
        <div class="filters-panel">
            <h3>üîç Advanced Filters</h3>
            <div class="filters-grid">
                <div class="filter-group">
                    <label>Search Title / Slug</label>
                    <input type="text" id="search-input" placeholder="Type to search...">
                </div>
                <div class="filter-group">
                    <label>Category</label>
                    <select id="category-filter">
                        <option value="">All Categories</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>SEO Score</label>
                    <select id="seo-filter">
                        <option value="">All Scores</option>
                        <option value="excellent">üü¢ Excellent (80+)</option>
                        <option value="good">üü° Good (60-79)</option>
                        <option value="needsWork">üü† Needs Work (40-59)</option>
                        <option value="poor">üî¥ Poor (&lt;40)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="status-filter">
                        <option value="">All Status</option>
                        <option value="orphan">‚ö†Ô∏è Orphan (No incoming links)</option>
                        <option value="hub">üåü Hub (10+ outgoing)</option>
                        <option value="featured">‚≠ê Featured</option>
                        <option value="no-image">üñºÔ∏è Missing Image</option>
                        <option value="no-faq">‚ùì No FAQ Section</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Word Count Range</label>
                    <div class="range-inputs">
                        <input type="number" id="words-min" placeholder="Min">
                        <span>to</span>
                        <input type="number" id="words-max" placeholder="Max">
                    </div>
                </div>
                <div class="filter-group">
                    <label>Internal Links From (Incoming)</label>
                    <div class="range-inputs">
                        <input type="number" id="links-from-min" placeholder="Min">
                        <span>to</span>
                        <input type="number" id="links-from-max" placeholder="Max">
                    </div>
                </div>
                <div class="filter-group">
                    <label>Internal Links To (Outgoing)</label>
                    <div class="range-inputs">
                        <input type="number" id="links-to-min" placeholder="Min">
                        <span>to</span>
                        <input type="number" id="links-to-max" placeholder="Max">
                    </div>
                </div>
                <div class="filter-group">
                    <label>External Links</label>
                    <div class="range-inputs">
                        <input type="number" id="ext-links-min" placeholder="Min">
                        <span>to</span>
                        <input type="number" id="ext-links-max" placeholder="Max">
                    </div>
                </div>
                <div class="filter-group">
                    <label>Difficulty Level</label>
                    <select id="difficulty-filter">
                        <option value="">All Levels</option>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Has Featured Image</label>
                    <select id="image-filter">
                        <option value="">Any</option>
                        <option value="yes">‚úÖ Yes</option>
                        <option value="no">‚ùå No</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Has FAQ Section</label>
                    <select id="faq-filter">
                        <option value="">Any</option>
                        <option value="yes">‚úÖ Yes</option>
                        <option value="no">‚ùå No</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button class="btn btn-primary" onclick="applyFilters()">üîç Apply Filters</button>
                <button class="btn btn-secondary" onclick="resetFilters()">‚Ü∫ Reset</button>
                <button class="btn btn-export" onclick="exportCSV()">üì• Export CSV</button>
            </div>
        </div>

        <div class="results-stats" id="results-stats"></div>

        <div class="table-container">
            <table class="data-table" id="posts-table">
                <thead>
                    <tr>
                        <th></th>
                        <th data-sort="title">Title <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="category">Category <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="wordCount">Words <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="linksFrom">From <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="linksTo">To <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="externalLinks">Ext <span class="sort-icon">‚Üï</span></th>
                        <th data-sort="seoScore">SEO <span class="sort-icon">‚Üï</span></th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <tr>
                        <td colspan="9" class="loading">Loading</td>
                    </tr>
                </tbody>
            </table>
            <div class="pagination" id="pagination"></div>
        </div>
    </div>

    <script>
        let analyticsData = null, filteredPosts = [], currentPage = 1, sortColumn = 'seoScore', sortDirection = 'desc';
        const postsPerPage = 30;

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
            });
        });

        async function loadData() {
            try {
                const r = await fetch('./blog-analytics.json');
                analyticsData = await r.json();
                document.getElementById('last-updated').textContent = 'Updated: ' + new Date(analyticsData._metadata.generatedAt).toLocaleString();
                renderSummaryCards(); renderSeoChart(); renderCategoryChart(); renderQuickStats();
                populateCategoryFilter(); applyFilters();
            } catch (e) {
                console.error(e);
                document.getElementById('summary-cards').innerHTML = '<div style="color:var(--accent-red);padding:20px;">Failed to load data</div>';
            }
        }

        function renderSummaryCards() {
            const s = analyticsData.summary;
            document.getElementById('summary-cards').innerHTML = `
                <div class="summary-card"><div class="value">${s.totalPosts}</div><div class="label">Total Posts</div></div>
                <div class="summary-card"><div class="value">${s.totalWords.toLocaleString()}</div><div class="label">Total Words</div></div>
                <div class="summary-card"><div class="value">${s.averageWordCount.toLocaleString()}</div><div class="label">Avg Words</div></div>
                <div class="summary-card"><div class="value">${s.totalInternalLinks}</div><div class="label">Internal Links</div></div>
                <div class="summary-card"><div class="value">${s.totalExternalLinks}</div><div class="label">External Links</div></div>
                <div class="summary-card ${s.averageSeoScore >= 70 ? 'excellent' : s.averageSeoScore >= 50 ? 'warning' : 'danger'}"><div class="value">${s.averageSeoScore}/100</div><div class="label">Avg SEO</div></div>
                <div class="summary-card ${s.orphanPageCount === 0 ? 'excellent' : 'warning'}"><div class="value">${s.orphanPageCount}</div><div class="label">Orphan Pages</div></div>
                <div class="summary-card excellent"><div class="value">${s.hubPageCount}</div><div class="label">Hub Pages</div></div>
            `;
        }

        function renderSeoChart() {
            const d = analyticsData.seoDistribution, max = Math.max(d.excellent, d.good, d.needsWork, d.poor) || 1;
            document.getElementById('seo-chart').innerHTML = ['excellent', 'good', 'needs-work', 'poor'].map((c, i) => {
                const v = [d.excellent, d.good, d.needsWork, d.poor][i];
                const l = ['Excellent', 'Good', 'Needs Work', 'Poor'][i];
                return `<div class="seo-bar ${c}"><div class="bar-container"><div class="bar" style="height:${(v / max) * 100}%"></div></div><div class="count">${v}</div><div class="label">${l}</div></div>`;
            }).join('');
        }

        function renderCategoryChart() {
            const cats = Object.entries(analyticsData.categoryBreakdown).sort((a, b) => b[1].count - a[1].count);
            const max = cats[0]?.[1].count || 1;
            document.getElementById('category-chart').innerHTML = cats.map(([n, d]) =>
                `<div class="category-item"><div class="name" title="${n}">${n}</div><div class="bar-bg"><div class="bar-fill" style="width:${(d.count / max) * 100}%">${d.count}</div></div></div>`
            ).join('');
        }

        function renderQuickStats() {
            const orphans = analyticsData.orphanPages.slice(0, 8);
            document.getElementById('orphan-list').innerHTML = orphans.length ? orphans.map(p =>
                `<div class="quick-stat-item"><a href="/blog/${p.slug}" target="_blank">${p.title}</a><span class="badge orphan">${p.seoScore}</span></div>`
            ).join('') : '<div class="quick-stat-item">No orphan pages! üéâ</div>';

            const hubs = analyticsData.hubPages.slice(0, 8);
            document.getElementById('hub-list').innerHTML = hubs.length ? hubs.map(p =>
                `<div class="quick-stat-item"><a href="/blog/${p.slug}" target="_blank">${p.title}</a><span class="badge hub">${p.linksToCount}</span></div>`
            ).join('') : '<div class="quick-stat-item">No hub pages</div>';
        }

        function populateCategoryFilter() {
            const sel = document.getElementById('category-filter');
            Object.keys(analyticsData.categoryBreakdown).sort().forEach(c => {
                const o = document.createElement('option'); o.value = c; o.textContent = c; sel.appendChild(o);
            });
        }

        function applyFilters() {
            const search = document.getElementById('search-input').value.toLowerCase();
            const cat = document.getElementById('category-filter').value;
            const seo = document.getElementById('seo-filter').value;
            const status = document.getElementById('status-filter').value;
            const diff = document.getElementById('difficulty-filter').value;
            const img = document.getElementById('image-filter').value;
            const faq = document.getElementById('faq-filter').value;
            const wordsMin = parseInt(document.getElementById('words-min').value) || 0;
            const wordsMax = parseInt(document.getElementById('words-max').value) || Infinity;
            const fromMin = parseInt(document.getElementById('links-from-min').value) || 0;
            const fromMax = parseInt(document.getElementById('links-from-max').value) || Infinity;
            const toMin = parseInt(document.getElementById('links-to-min').value) || 0;
            const toMax = parseInt(document.getElementById('links-to-max').value) || Infinity;
            const extMin = parseInt(document.getElementById('ext-links-min').value) || 0;
            const extMax = parseInt(document.getElementById('ext-links-max').value) || Infinity;

            filteredPosts = analyticsData.posts.filter(p => {
                if (search && !p.title.toLowerCase().includes(search) && !p.slug.toLowerCase().includes(search)) return false;
                if (cat && p.category !== cat) return false;
                if (seo && p.seoStatus.status !== seo) return false;
                if (status === 'orphan' && !p.isOrphan) return false;
                if (status === 'hub' && !p.isHub) return false;
                if (status === 'featured' && !p.featured) return false;
                if (status === 'no-image' && p.heroImage) return false;
                if (status === 'no-faq' && p.hasFaq) return false;
                if (diff && p.difficulty !== diff) return false;
                if (img === 'yes' && !p.heroImage) return false;
                if (img === 'no' && p.heroImage) return false;
                if (faq === 'yes' && !p.hasFaq) return false;
                if (faq === 'no' && p.hasFaq) return false;
                if (p.wordCount < wordsMin || p.wordCount > wordsMax) return false;
                if (p.linksFrom.length < fromMin || p.linksFrom.length > fromMax) return false;
                if (p.linksTo.length < toMin || p.linksTo.length > toMax) return false;
                if (p.externalLinks.length < extMin || p.externalLinks.length > extMax) return false;
                return true;
            });

            sortPosts(); currentPage = 1; renderTable(); renderPagination(); renderResultsStats();
        }

        function resetFilters() {
            document.querySelectorAll('.filters-panel input, .filters-panel select').forEach(el => el.value = '');
            applyFilters();
        }

        function sortPosts() {
            filteredPosts.sort((a, b) => {
                let av, bv;
                switch (sortColumn) {
                    case 'title': av = a.title.toLowerCase(); bv = b.title.toLowerCase(); break;
                    case 'category': av = a.category; bv = b.category; break;
                    case 'wordCount': av = a.wordCount; bv = b.wordCount; break;
                    case 'linksFrom': av = a.linksFrom.length; bv = b.linksFrom.length; break;
                    case 'linksTo': av = a.linksTo.length; bv = b.linksTo.length; break;
                    case 'externalLinks': av = a.externalLinks.length; bv = b.externalLinks.length; break;
                    default: av = a.seoScore; bv = b.seoScore;
                }
                if (typeof av === 'string') return sortDirection === 'asc' ? av.localeCompare(bv) : bv.localeCompare(av);
                return sortDirection === 'asc' ? av - bv : bv - av;
            });
        }

        function renderResultsStats() {
            const fp = filteredPosts;
            const avgSeo = fp.length ? Math.round(fp.reduce((s, p) => s + p.seoScore, 0) / fp.length) : 0;
            const avgWords = fp.length ? Math.round(fp.reduce((s, p) => s + p.wordCount, 0) / fp.length) : 0;
            const orphans = fp.filter(p => p.isOrphan).length;
            document.getElementById('results-stats').innerHTML = `
                <div class="results-stat"><span class="num">${fp.length}</span> posts found</div>
                <div class="results-stat">Avg SEO: <span class="num">${avgSeo}</span></div>
                <div class="results-stat">Avg Words: <span class="num">${avgWords.toLocaleString()}</span></div>
                <div class="results-stat">Orphans: <span class="num">${orphans}</span></div>
            `;
        }

        function renderTable() {
            const start = (currentPage - 1) * postsPerPage, end = start + postsPerPage;
            const posts = filteredPosts.slice(start, end);

            document.getElementById('table-body').innerHTML = posts.length ? posts.map((p, i) => {
                const idx = start + i;
                const tags = [];
                if (p.isOrphan) tags.push('<span class="status-tag orphan">Orphan</span>');
                if (p.isHub) tags.push('<span class="status-tag hub">Hub</span>');
                if (p.featured) tags.push('<span class="status-tag featured">Featured</span>');
                if (!p.heroImage) tags.push('<span class="status-tag no-image">No Img</span>');
                if (!p.hasFaq) tags.push('<span class="status-tag no-faq">No FAQ</span>');

                return `<tr data-idx="${idx}">
                    <td><button class="expand-btn" onclick="toggleExpand(${idx})">‚ñ∂</button></td>
                    <td><div class="post-title"><a href="/blog/${p.slug}" target="_blank">${esc(p.title)}</a><span class="slug">/${p.slug}</span></div></td>
                    <td><span class="category-badge">${p.category}</span></td>
                    <td class="num-cell ${p.wordCount >= 4000 ? 'high' : p.wordCount < 2000 ? 'low' : ''}">${p.wordCount.toLocaleString()}</td>
                    <td class="num-cell ${p.linksFrom.length === 0 ? 'zero' : ''}">${p.linksFrom.length}</td>
                    <td class="num-cell ${p.linksTo.length === 0 ? 'zero' : ''}">${p.linksTo.length}</td>
                    <td class="num-cell ${p.externalLinks.length === 0 ? 'zero' : ''}">${p.externalLinks.length}</td>
                    <td><span class="seo-badge ${p.seoStatus.status}">${p.seoScore}</span></td>
                    <td><div class="status-tags">${tags.join('')}</div></td>
                </tr>
                <tr class="expanded-row"><td colspan="9"><div class="expanded-content" id="content-${idx}">${renderExpanded(p)}</div></td></tr>`;
            }).join('') : '<tr><td colspan="9" style="text-align:center;padding:40px;color:var(--text-secondary);">No posts match filters</td></tr>';
        }

        function renderExpanded(p) {
            return `<div class="expanded-grid">
                <div class="expanded-section"><h4>üì• Links From (${p.linksFrom.length})</h4><ul>${p.linksFrom.slice(0, 8).map(l => `<li><a href="/blog/${l.slug}" target="_blank">${esc(l.title)}</a></li>`).join('') || '<li>None</li>'}${p.linksFrom.length > 8 ? `<li>+${p.linksFrom.length - 8} more</li>` : ''}</ul></div>
                <div class="expanded-section"><h4>üì§ Links To (${p.linksTo.length})</h4><ul>${p.linksTo.slice(0, 8).map(l => `<li><a href="${l.url}" target="_blank">${esc(l.anchorText)}</a></li>`).join('') || '<li>None</li>'}${p.linksTo.length > 8 ? `<li>+${p.linksTo.length - 8} more</li>` : ''}</ul></div>
                <div class="expanded-section"><h4>üîó External (${p.externalLinks.length})</h4><ul>${p.externalLinks.slice(0, 8).map(l => `<li><a href="${l.url}" target="_blank">${esc(l.domain)}</a></li>`).join('') || '<li>None</li>'}${p.externalLinks.length > 8 ? `<li>+${p.externalLinks.length - 8} more</li>` : ''}</ul></div>
            </div>
            <div class="expanded-section" style="margin-top:12px"><h4>üìä SEO Breakdown (${p.seoScore}/100)</h4><div class="seo-breakdown">
                <div class="seo-metric"><span class="name">Title</span><span class="points">${p.seoBreakdown.titleLength}/15</span></div>
                <div class="seo-metric"><span class="name">Description</span><span class="points">${p.seoBreakdown.descriptionLength}/15</span></div>
                <div class="seo-metric"><span class="name">Words</span><span class="points">${p.seoBreakdown.wordCount}/20</span></div>
                <div class="seo-metric"><span class="name">Links To</span><span class="points">${p.seoBreakdown.linksTo}/15</span></div>
                <div class="seo-metric"><span class="name">External</span><span class="points">${p.seoBreakdown.externalLinks}/10</span></div>
                <div class="seo-metric"><span class="name">Image</span><span class="points">${p.seoBreakdown.featuredImage}/10</span></div>
                <div class="seo-metric"><span class="name">FAQ</span><span class="points">${p.seoBreakdown.faqSection}/5</span></div>
                <div class="seo-metric"><span class="name">Category</span><span class="points">${p.seoBreakdown.category}/5</span></div>
                <div class="seo-metric"><span class="name">Tags</span><span class="points">${p.seoBreakdown.tags}/5</span></div>
            </div></div>`;
        }

        function toggleExpand(idx) {
            const c = document.getElementById('content-' + idx);
            const btn = document.querySelector(`tr[data-idx="${idx}"] .expand-btn`);
            if (c.classList.contains('show')) { c.classList.remove('show'); btn.textContent = '‚ñ∂'; }
            else { c.classList.add('show'); btn.textContent = '‚ñº'; }
        }

        function renderPagination() {
            const total = Math.ceil(filteredPosts.length / postsPerPage);
            const start = (currentPage - 1) * postsPerPage + 1;
            const end = Math.min(currentPage * postsPerPage, filteredPosts.length);

            let pages = '';
            for (let i = 1; i <= total; i++) {
                if (i === 1 || i === total || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    pages += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    pages += '<span style="color:var(--text-muted);padding:0 4px">...</span>';
                }
            }

            document.getElementById('pagination').innerHTML = `
                <div class="pagination-info">Showing ${filteredPosts.length ? start : 0}-${end} of ${filteredPosts.length}</div>
                <div class="pagination-controls">
                    <button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‚Üê</button>
                    ${pages}
                    <button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage >= total ? 'disabled' : ''}>‚Üí</button>
                </div>
            `;
        }

        function goToPage(p) {
            const total = Math.ceil(filteredPosts.length / postsPerPage);
            if (p < 1 || p > total) return;
            currentPage = p; renderTable(); renderPagination();
            document.querySelector('.table-container').scrollIntoView({ behavior: 'smooth' });
        }

        document.querySelectorAll('.data-table th[data-sort]').forEach(th => {
            th.addEventListener('click', () => {
                const col = th.dataset.sort;
                if (sortColumn === col) sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                else { sortColumn = col; sortDirection = 'desc'; }
                document.querySelectorAll('.data-table th').forEach(h => h.classList.remove('sorted'));
                th.classList.add('sorted');
                th.querySelector('.sort-icon').textContent = sortDirection === 'asc' ? '‚Üë' : '‚Üì';
                sortPosts(); currentPage = 1; renderTable(); renderPagination();
            });
        });

        document.getElementById('search-input').addEventListener('input', debounce(applyFilters, 300));

        function exportCSV() {
            const h = ['Title', 'Slug', 'Category', 'Words', 'Links From', 'Links To', 'External', 'SEO Score', 'Has Image', 'Has FAQ', 'Status'];
            const rows = filteredPosts.map(p => [
                `"${p.title.replace(/"/g, '""')}"`, p.slug, p.category, p.wordCount, p.linksFrom.length, p.linksTo.length,
                p.externalLinks.length, p.seoScore, p.heroImage ? 'Yes' : 'No', p.hasFaq ? 'Yes' : 'No',
                [p.isOrphan ? 'Orphan' : '', p.isHub ? 'Hub' : '', p.featured ? 'Featured' : ''].filter(Boolean).join('; ')
            ]);
            const csv = [h.join(','), ...rows.map(r => r.join(','))].join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
            a.download = `blog-analytics-${new Date().toISOString().split('T')[0]}.csv`; a.click();
        }

        function debounce(fn, wait) { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), wait); }; }
        function esc(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

        loadData();
    </script>
</body>

</html>