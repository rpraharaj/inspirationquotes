---
/**
 * ArticleCard Component
 * 
 * Displays an article preview card for grids and lists.
 */
import type { CollectionEntry } from 'astro:content';
import FormattedDate from '../FormattedDate.astro';
import CategoryBadge from './CategoryBadge.astro';
import Icon from './Icon.astro';
import { type CategorySlug } from '../../config/categories';

interface Props {
  post: CollectionEntry<'blog'>;
  index?: number;
  showReadMore?: boolean;
}

const { post, index = 0, showReadMore = false } = Astro.props;
---

<article class:list={['group animate-slide-up', `stagger-${index + 1}`]}>
  <a href={`/${post.id}/`} class="block">
    <div class="aspect-video overflow-hidden rounded-xl bg-background-secondary border border-border mb-4">
      {post.data.heroImage ? (
        <img 
          src={post.data.heroImage} 
          alt={`Featured image for ${post.data.title}`}
          width={480}
          height={270}
          class="w-full h-full object-cover transition-all duration-500 group-hover:scale-105"
          loading="lazy"
          decoding="async"
        />
      ) : (
        <div class="w-full h-full flex items-center justify-center text-foreground-tertiary">
          <Icon name="file-code" size={48} strokeWidth={1} />
        </div>
      )}
    </div>
    
    <div class="flex flex-wrap items-center gap-2 mb-3">
      <CategoryBadge category={post.data.category as CategorySlug} size="sm" showIcon={false} />
      <span class="text-foreground-tertiary">Â·</span>
      <span class="text-xs text-foreground-tertiary">
        <FormattedDate date={post.data.pubDate} />
      </span>
    </div>
    
    <h3 class="text-lg font-bold tracking-tight mb-2 group-hover:text-foreground-secondary transition-colors line-clamp-2">
      {post.data.title}
    </h3>
    
    {post.data.description && (
      <p class="text-sm text-foreground-secondary line-clamp-2">
        {post.data.description}
      </p>
    )}
    
    {showReadMore && (
      <span class="inline-flex items-center gap-1 mt-4 text-sm font-medium text-foreground-secondary group-hover:text-foreground transition-colors">
        Read article
        <Icon name="arrow-right" size={16} class="transition-transform group-hover:translate-x-1" />
      </span>
    )}
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
