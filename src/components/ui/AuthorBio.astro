---
/**
 * AuthorBio Component
 * 
 * Displays author information with avatar, expertise, and social links
 * Enhanced with E-E-A-T signals for Google compliance
 */
import { getAuthor, type Author } from '../../config/authors';
import Icon from './Icon.astro';

interface Props {
  authorId?: string;
  compact?: boolean;
  showAchievements?: boolean;
}

const { authorId, compact = false, showAchievements = false } = Astro.props;
const author = getAuthor(authorId);
---

<div class:list={[
  'author-bio border border-border rounded-xl',
  compact ? 'p-4' : 'p-6'
]}>
  <div class:list={[
    'flex',
    compact ? 'items-center gap-4' : 'flex-col gap-4'
  ]}>
    
    <!-- Avatar -->
    {author.avatar && !compact && (
      <div class="w-20 h-20 rounded-full overflow-hidden border-2 border-border bg-background-secondary flex-shrink-0">
        <img 
          src={author.avatar} 
          alt={`${author.name} avatar`}
          width={80}
          height={80}
          class="w-full h-full object-cover"
          loading="lazy"
          onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'flex items-center justify-center w-full h-full text-foreground-tertiary\\'><svg width=\\'32\\' height=\\'32\\' viewBox=\\'0 0 24 24\\' fill=\\'none\\' stroke=\\'currentColor\\' stroke-width=\\'1.5\\'><path d=\\'M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\\'></path><circle cx=\\'12\\' cy=\\'7\\' r=\\'4\\'></circle></svg></div>'"
        />
      </div>
    )}
    
    <!-- Info -->
    <div class="flex-1 min-w-0">
      <div class="flex flex-wrap items-baseline gap-2">
        <h3 class:list={[
          'font-bold text-foreground',
          compact ? 'text-base' : 'text-lg'
        ]}>
          {author.name}
        </h3>
        {author.role && (
          <span class="text-sm text-foreground-tertiary">
            {author.role}
          </span>
        )}
      </div>
      
      <!-- Experience Badge -->
      {!compact && author.experience && (
        <div class="mt-2">
          <span class="inline-flex items-center gap-1.5 text-xs font-medium px-2 py-1 rounded-full bg-background-secondary border border-border text-foreground-secondary">
            <Icon name="zap" size={12} />
            {author.experience} experience
          </span>
        </div>
      )}
      
      {!compact && author.bio && (
        <p class="text-foreground-secondary text-sm mt-3 leading-relaxed">
          {author.bio}
        </p>
      )}
      
      <!-- Expertise Tags -->
      {!compact && author.expertise && author.expertise.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-4">
          {author.expertise.slice(0, 5).map((skill) => (
            <span class="text-xs px-2 py-1 rounded-md bg-background-secondary border border-border text-foreground-tertiary">
              {skill}
            </span>
          ))}
        </div>
      )}
      
      <!-- Achievements (optional) -->
      {showAchievements && author.achievements && author.achievements.length > 0 && (
        <div class="mt-4 pt-4 border-t border-border">
          <h4 class="text-xs font-bold uppercase tracking-wider text-foreground-tertiary mb-2">
            Notable Achievements
          </h4>
          <ul class="space-y-1.5">
            {author.achievements.map((achievement) => (
              <li class="flex items-start gap-2 text-sm text-foreground-secondary">
                <Icon name="check" size={14} class="text-foreground-tertiary mt-0.5 flex-shrink-0" />
                <span>{achievement}</span>
              </li>
            ))}
          </ul>
        </div>
      )}
      
      <!-- Social Links -->
      {author.social && (
        <div class:list={[
          'flex items-center gap-2',
          compact ? 'mt-1' : 'mt-4'
        ]}>
          {author.social.twitter && (
            <a 
              href={author.social.twitter}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name} on Twitter`}
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
          )}
          {author.social.github && (
            <a 
              href={author.social.github}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name} on GitHub`}
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
              </svg>
            </a>
          )}
          {author.social.linkedin && (
            <a 
              href={author.social.linkedin}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name} on LinkedIn`}
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          )}
          {author.social.website && (
            <a 
              href={author.social.website}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name}'s website`}
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
              </svg>
            </a>
          )}
        </div>
      )}
    </div>
  </div>
</div>
