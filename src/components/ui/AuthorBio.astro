---
/**
 * AuthorBio Component
 * 
 * Displays author information with avatar, expertise, and social links
 * Enhanced with E-E-A-T signals for Google compliance
 */
import { getAuthor, type Author } from '../../config/authors';
import Icon from './Icon.astro';

interface Props {
  authorId?: string;
  compact?: boolean;
  showAchievements?: boolean;
}

const { authorId, compact = false, showAchievements = false } = Astro.props;
const author = getAuthor(authorId);
---

<div class:list={[
  'author-bio border border-border rounded-xl',
  compact ? 'p-4' : 'p-6'
]}>
  <div class:list={[
    'flex',
    compact ? 'items-center gap-4' : 'flex-col gap-4'
  ]}>
    
    <!-- Avatar -->
    {author.avatar && !compact && (
      <div class="w-20 h-20 rounded-full overflow-hidden border-2 border-border bg-background-secondary flex-shrink-0">
        <img 
          src={author.avatar} 
          alt={`${author.name} avatar`}
          width={80}
          height={80}
          class="w-full h-full object-cover"
          loading="lazy"
          onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden');"
        />
        <div class="hidden items-center justify-center w-full h-full text-foreground-tertiary">
          <Icon name="bot" size={32} strokeWidth={1.5} />
        </div>
      </div>
    )}
    
    <!-- Info -->
    <div class="flex-1 min-w-0">
      <div class="flex flex-wrap items-baseline gap-2">
        <h3 class:list={[
          'font-bold text-foreground',
          compact ? 'text-base' : 'text-lg'
        ]}>
          {author.name}
        </h3>
        {author.role && (
          <span class="text-sm text-foreground-tertiary">
            {author.role}
          </span>
        )}
      </div>
      
      <!-- Experience Badge -->
      {!compact && author.experience && (
        <div class="mt-2">
          <span class="inline-flex items-center gap-1.5 text-xs font-medium px-2 py-1 rounded-full bg-background-secondary border border-border text-foreground-secondary">
            <Icon name="zap" size={12} />
            {author.experience} experience
          </span>
        </div>
      )}
      
      {!compact && author.bio && (
        <p class="text-foreground-secondary text-sm mt-3 leading-relaxed">
          {author.bio}
        </p>
      )}
      
      <!-- Expertise Tags -->
      {!compact && author.expertise && author.expertise.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-4">
          {author.expertise.slice(0, 5).map((skill) => (
            <span class="text-xs px-2 py-1 rounded-md bg-background-secondary border border-border text-foreground-tertiary">
              {skill}
            </span>
          ))}
        </div>
      )}
      
      <!-- Achievements (optional) -->
      {showAchievements && author.achievements && author.achievements.length > 0 && (
        <div class="mt-4 pt-4 border-t border-border">
          <h4 class="text-xs font-bold uppercase tracking-wider text-foreground-tertiary mb-2">
            Notable Achievements
          </h4>
          <ul class="space-y-1.5">
            {author.achievements.map((achievement) => (
              <li class="flex items-start gap-2 text-sm text-foreground-secondary">
                <Icon name="check" size={14} class="text-foreground-tertiary mt-0.5 flex-shrink-0" />
                <span>{achievement}</span>
              </li>
            ))}
          </ul>
        </div>
      )}
      
      <!-- Social Links -->
      {author.social && (
        <div class:list={[
          'flex items-center gap-2',
          compact ? 'mt-1' : 'mt-4'
        ]}>


          {author.social.pinterest && (
            <a 
              href={author.social.pinterest}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name} on Pinterest`}
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 0C5.373 0 0 5.372 0 12c0 5.084 3.163 9.426 7.627 11.174-.105-.949-.2-2.405.042-3.441.218-.937 1.407-5.965 1.407-5.965s-.359-.719-.359-1.782c0-1.668.967-2.914 2.171-2.914 1.023 0 1.518.769 1.518 1.69 0 1.029-.655 2.568-.994 3.995-.283 1.194.599 2.169 1.777 2.169 2.133 0 3.772-2.249 3.772-5.495 0-2.873-2.064-4.882-5.012-4.882-3.414 0-5.418 2.561-5.418 5.207 0 1.031.397 2.138.893 2.738.098.119.112.224.083.345l-.333 1.36c-.053.22-.174.267-.402.161-1.499-.698-2.436-2.889-2.436-4.649 0-3.785 2.75-7.262 7.929-7.262 4.163 0 7.398 2.967 7.398 6.931 0 4.136-2.607 7.464-6.227 7.464-1.216 0-2.359-.631-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24 12 24c6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12z"/>
              </svg>
            </a>
          )}
          {author.social.linkedin && (
            <a 
              href={author.social.linkedin}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name} on LinkedIn`}
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          )}
          {author.social.website && (
            <a 
              href={author.social.website}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1.5 text-foreground-tertiary hover:text-foreground transition-colors"
              aria-label={`${author.name}'s website`}
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
              </svg>
            </a>
          )}
        </div>
      )}
    </div>
  </div>
</div>
