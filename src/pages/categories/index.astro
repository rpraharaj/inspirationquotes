---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import CategoryTile from '../../components/ui/CategoryTile.astro';
import Icon from '../../components/ui/Icon.astro';
import { categories } from '../../config/categories';
import { siteConfig } from '../../config/site';

// Get all posts to count per category
const allPosts = await getCollection('blog');

// Count articles per category
const categoryArticleCounts = categories.reduce((acc, cat) => {
  acc[cat.slug] = allPosts.filter(p => p.data.category === cat.slug).length;
  return acc;
}, {} as Record<string, number>);

const totalArticles = allPosts.length;
---

<BaseLayout 
  title="Browse Quote Topics: Wisdom, Motivation, Love & More | Inspiration Quotes Hub" 
  description={`Explore ${totalArticles}+ quotes across ${categories.length} topics. Find curated collections for motivation, life lessons, mindfulness, and more.`}
>
  <div class="py-16 sm:py-24">
    <div class="mx-auto max-w-wide px-4 sm:px-6">
      <!-- Header -->
      <header class="mb-12 animate-fade-in">
        <div class="flex items-center gap-3 mb-4">
          <Icon name="layers" size={32} class="text-foreground-secondary" />
          <h1 class="text-3xl sm:text-4xl font-bold tracking-tight">Categories</h1>
        </div>
        <p class="text-lg text-foreground-secondary max-w-2xl">
          Explore {totalArticles} articles across {categories.length} categories. 
          From AI news to code snippets, find exactly what you're looking for.
        </p>
      </header>
      
      <!-- Categories Grid -->
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {categories.map((category, index) => (
          <div class:list={['animate-slide-up', `stagger-${Math.min(index + 1, 4)}`]}>
            <CategoryTile 
              category={category} 
              articleCount={categoryArticleCounts[category.slug] || 0}
              size="lg"
            />
          </div>
        ))}
      </div>
      
      <!-- All Articles CTA -->
      <div class="mt-16 text-center">
        <div class="inline-block p-8 rounded-2xl border border-border bg-background-secondary">
          <p class="text-foreground-secondary mb-4">
            Looking for something specific?
          </p>
          <a 
            href="/blog" 
            class="inline-flex items-center justify-center gap-2 px-6 py-3 text-sm font-medium bg-foreground text-background rounded-xl hover:opacity-90 transition-all duration-200"
          >
            Browse All Articles
            <Icon name="arrow-right" size={16} />
          </a>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>
